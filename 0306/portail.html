<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portail prévention PACA</title>

  <!-- CSS commun + CSS portail -->
  <link rel="icon" href="../favicon.ico">

  <link rel="stylesheet" href="../css/pp-core.css" />
  <link rel="stylesheet" href="../css/pp-portail.css" />
<style>
  #pp-wait-overlay{
    position:fixed; inset:0; z-index:99999;
    display:flex; align-items:center; justify-content:center;
    padding:24px;
    background:rgba(10,14,22,.92);
    backdrop-filter:blur(3px);
    -webkit-backdrop-filter:blur(3px);
    transition:opacity .18s ease;
  }
  #pp-wait-overlay.pp-hide{ opacity:0; pointer-events:none; }

  .pp-wait-card{
    width:min(520px,92vw);
    background:rgba(18,24,38,.92);
    border:1px solid rgba(255,255,255,.10);
    border-radius:16px;
    box-shadow:0 16px 50px rgba(0,0,0,.35);
    padding:16px 18px;
  }
  .pp-wait-top{ display:flex; gap:12px; align-items:center; }
  .pp-spinner{
    width:34px; height:34px; border-radius:50%;
    border:4px solid rgba(255,255,255,.18);
    border-top-color:rgba(255,255,255,.85);
    animation:pp-spin .85s linear infinite;
    flex:0 0 auto;
  }
  @keyframes pp-spin{ to{ transform:rotate(360deg);} }

  .pp-wait-title{
    font-weight:800;
    color:rgba(255,255,255,.92);
    margin:0;
    font-size:15px;
    line-height:1.2;
    letter-spacing:.2px;
  }

  html.pp-lock, body.pp-lock{ overflow:hidden; }
</style>

<div id="pp-wait-overlay" aria-live="polite" aria-busy="true">
  <div class="pp-wait-card">
    <div class="pp-wait-top">
      <div class="pp-spinner" aria-hidden="true"></div>
      <p class="pp-wait-title">Chargement des tuiles du portail…</p>
    </div>
  </div>
</div>
      <p class="pp-wait-title">Chargement des tuiles du portail…</p>
    </div>
  </div>
</div>






  
<script type="module">
import { isInGristWidget } from "../js/pp-runtime.js";
</script>
  <!-- Script Grist -->
  <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>

<script>
(function(){
  const overlay = document.getElementById('pp-wait-overlay');
  if(!overlay) return;

  document.documentElement.classList.add('pp-lock');
  document.body.classList.add('pp-lock');

  function hide(){
    overlay.classList.add('pp-hide');
    setTimeout(() => {
      overlay.remove();
      document.documentElement.classList.remove('pp-lock');
      document.body.classList.remove('pp-lock');
    }, 200);
  }

  function tilesReadyNow(){
    const grid = document.getElementById('tileGrid');
    return !!(grid && grid.querySelector('.tile'));
  }

  if (window.__PP_TILES_RENDERED || tilesReadyNow()){
    hide();
    return;
  }

  window.addEventListener('pp:tiles-rendered', hide, { once:true });

  setTimeout(() => {
    if (document.getElementById('pp-wait-overlay')) hide();
  }, 20000);
})();
</script>


</body>
</html>
