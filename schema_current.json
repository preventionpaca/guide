[
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Submission_Date",
    "label": "Submission Date",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Equipements_ou_produits",
    "label": "Equipements ou produits",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Article_du_code_du_travail",
    "label": "Article du code du travail",
    "type": "RefList:Articles_code_du_travail",
    "isFormula": true,
    "formula": "import re\ndef _split(s):\n  return [t.strip() for t in re.split(r'[;/]', s or '') if t.strip()]\nresult = []\nfor t in _split($Tampon_Articles):\n  r = Articles_du_Code_du_Travail.lookupOne(Numero=t)\n  if r:\n    result.append(r)\nreturn result\n",
    "isRef": true,
    "refTableId": "Articles_code_du_travail",
    "visibleCol": 58,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Observations_particulieres",
    "label": "Observations particulières",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 4
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Domaines_professionnels",
    "label": "Domaines professionnels",
    "type": "RefList:Domaine_professionnel",
    "isFormula": true,
    "formula": "import re, unicodedata\n\ndef _norm(s):\n  if not s: return ''\n  s = unicodedata.normalize('NFKD', str(s))\n  s = ''.join(ch for ch in s if unicodedata.category(ch) != 'Mn')   # supprime accents\n  s = re.sub(r'[-‐-‒–—―]+', ' ', s)              ",
    "isRef": true,
    "refTableId": "Domaine_professionnel",
    "visibleCol": 23,
    "description": "",
    "pos": 5
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_Display2",
    "label": "gristHelper_Display2",
    "type": "Any",
    "isFormula": true,
    "formula": "$Domaines_professionnels.Domaines",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 6
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_Display3",
    "label": "gristHelper_Display3",
    "type": "Any",
    "isFormula": true,
    "formula": "$Article_du_code_du_travail.Numero",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 7
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Precisions_regime_d_interdiction_derogation",
    "label": "Précisions régime d'interdiction / dérogation",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 8
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Verification_Generale_Periodique",
    "label": "Vérification Générale Périodique",
    "type": "Ref:VGP",
    "isFormula": false,
    "formula": "",
    "isRef": true,
    "refTableId": "VGP",
    "visibleCol": 82,
    "description": "",
    "pos": 9
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_Display",
    "label": "gristHelper_Display",
    "type": "Any",
    "isFormula": true,
    "formula": "$Verification_Generale_Periodique.A",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 10
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Recommandations",
    "label": "Recommandations",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 11
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Travaux",
    "label": "Travaux",
    "type": "RefList:Risques",
    "isFormula": true,
    "formula": "import re\ndef _split(s):\n  return [t.strip() for t in re.split(r'[;/]', s or '') if t.strip()]\nresult = []\nfor t in _split($Tampon_Travaux):\n  r = Risques.lookupOne(Travaux=t)\n  if r:\n    result.append(r)\nreturn result\n",
    "isRef": true,
    "refTableId": "Risques",
    "visibleCol": 88,
    "description": "",
    "pos": 12
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Diplomes_concernes",
    "label": "Diplômes concernés",
    "type": "RefList:Diplomes_EN_OK",
    "isFormula": true,
    "formula": "import re, unicodedata\n\ndef _norm(s):\n  if not s: return ''\n  s = unicodedata.normalize('NFKD', str(s))\n  s = ''.join(ch for ch in s if unicodedata.category(ch) != 'Mn')\n  s = re.sub(r'[-‐-‒–—―]+', ' ', s)\n  s = re.sub(r\"[’'\\\":,;.!?(){}\\[\\]",
    "isRef": true,
    "refTableId": "Diplomes_EN_OK",
    "visibleCol": 221,
    "description": "",
    "pos": 13
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Etab",
    "label": "Etab",
    "type": "RefList:Etablissements_edi",
    "isFormula": true,
    "formula": "import re, unicodedata\n\ndef _norm(s):\n  if not s: return ''\n  s = unicodedata.normalize('NFKD', str(s))\n  s = ''.join(ch for ch in s if unicodedata.category(ch) != 'Mn')\n  s = re.sub(r'[-‐-‒–—―]+', ' ', s)   # normalise tous les tirets (cas",
    "isRef": true,
    "refTableId": "Etablissements_edi",
    "visibleCol": 114,
    "description": "",
    "pos": 14
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_Display7",
    "label": "gristHelper_Display7",
    "type": "Any",
    "isFormula": true,
    "formula": "$Etab.appellation_officielle",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 15
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Photo",
    "label": "Photo",
    "type": "Attachments",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 16
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Nature_des_travaux",
    "label": "Nature des travaux",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 17
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_Display6",
    "label": "gristHelper_Display6",
    "type": "Any",
    "isFormula": true,
    "formula": "$Diplomes_concernes.Concatenation",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 18
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_ConditionalRule2",
    "label": "gristHelper_ConditionalRule2",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 19
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "D",
    "label": "D",
    "type": "ChoiceList",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 20
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "E",
    "label": "E",
    "type": "Text",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 21
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Doc_bureau_de_controle",
    "label": "Doc bureau de contrôle",
    "type": "ChoiceList",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 22
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_Display8",
    "label": "gristHelper_Display8",
    "type": "Any",
    "isFormula": true,
    "formula": "$Travaux.Travaux2",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 23
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Picto",
    "label": "Picto",
    "type": "Text",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 24
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_ConditionalRule3",
    "label": "gristHelper_ConditionalRule3",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 25
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_RowConditionalRule",
    "label": "gristHelper_RowConditionalRule",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 26
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "verrouillage",
    "label": "verrouillage",
    "type": "Choice",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 27
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_RowConditionalRule2",
    "label": "gristHelper_RowConditionalRule2",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 28
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Regime_interdiction",
    "label": "Regime_interdiction",
    "type": "Ref:Derogation",
    "isFormula": false,
    "formula": "",
    "isRef": true,
    "refTableId": "Derogation",
    "visibleCol": 72,
    "description": "",
    "pos": 29
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "gristHelper_Display10",
    "label": "gristHelper_Display10",
    "type": "Any",
    "isFormula": true,
    "formula": "$Regime_interdiction.A",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 30
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Tampon_Domaines",
    "label": "Tampon_Domaines",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 31
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Tampon_Diplomes",
    "label": "Tampon_Diplomes",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 32
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Tampon_Etab",
    "label": "Tampon_Etab",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 33
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Tampon_Travaux",
    "label": "Tampon_Travaux",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 34
  },
  {
    "tableId": "Liste_des_equipements",
    "tableRef": 1,
    "colId": "Tampon_Articles",
    "label": "Tampon_Articles",
    "type": "Text",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 35
  },
  {
    "tableId": "Domaine_professionnel",
    "tableRef": 5,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Domaine_professionnel",
    "tableRef": 5,
    "colId": "Domaines",
    "label": "Domaines",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Domaine_professionnel",
    "tableRef": 5,
    "colId": "Correspondance",
    "label": "Correspondance",
    "type": "Text",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Articles_code_du_travail",
    "tableRef": 9,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Articles_code_du_travail",
    "tableRef": 9,
    "colId": "Numero",
    "label": "Numéro",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Articles_code_du_travail",
    "tableRef": 9,
    "colId": "URL",
    "label": "URL",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Articles_code_du_travail",
    "tableRef": 9,
    "colId": "Intitule",
    "label": "Intitulé",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "Articles_code_du_travail",
    "tableRef": 9,
    "colId": "gristHelper_ConditionalRule",
    "label": "gristHelper_ConditionalRule",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 4
  },
  {
    "tableId": "Photos_visio_im",
    "tableRef": 10,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Photos_visio_im",
    "tableRef": 10,
    "colId": "Url_Photo",
    "label": "Url Photo",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Photos_visio_im",
    "tableRef": 10,
    "colId": "Equipement",
    "label": "Equipement",
    "type": "Ref:Liste_des_equipements",
    "isFormula": false,
    "formula": "",
    "isRef": true,
    "refTableId": "Liste_des_equipements",
    "visibleCol": 3,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Photos_visio_im",
    "tableRef": 10,
    "colId": "gristHelper_Display",
    "label": "gristHelper_Display",
    "type": "Any",
    "isFormula": true,
    "formula": "$Equipement.Equipements_ou_produits",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "Photos_visio_im",
    "tableRef": 10,
    "colId": "A",
    "label": "A",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 4
  },
  {
    "tableId": "Derogation",
    "tableRef": 11,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Derogation",
    "tableRef": 11,
    "colId": "A",
    "label": "A",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Derogation",
    "tableRef": 11,
    "colId": "B",
    "label": "B",
    "type": "Text",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Derogation",
    "tableRef": 11,
    "colId": "C",
    "label": "C",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "VGP",
    "tableRef": 12,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "VGP",
    "tableRef": 12,
    "colId": "A",
    "label": "A",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "VGP",
    "tableRef": 12,
    "colId": "Doc_vgp",
    "label": "Doc vgp",
    "type": "Attachments",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "VGP",
    "tableRef": 12,
    "colId": "C",
    "label": "C",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "Travaux2",
    "label": "Travaux",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "Travaux_frappes_d_interdiction_totale",
    "label": "Travaux frappés d'interdiction totale",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "Travaux_interdits_soumis_a_derogation_ou_Travaux_reglementes",
    "label": "Travaux interdits soumis à dérogation ou Travaux réglementés",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "Travaux",
    "label": "Travaux",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 4
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "Travaux_autorise_non_soumis_a_declaration_de_derogation",
    "label": "Travaux autorisé non soumis à déclaration de dérogation",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 5
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "N_de_fiche",
    "label": "N° de fiche",
    "type": "Ref:Fiches_des_travaux",
    "isFormula": false,
    "formula": "",
    "isRef": true,
    "refTableId": "Fiches_des_travaux",
    "visibleCol": 155,
    "description": "",
    "pos": 6
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "gristHelper_Display2",
    "label": "gristHelper_Display2",
    "type": "Any",
    "isFormula": true,
    "formula": "$N_de_fiche.N_de_fiche",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 7
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "Fiche_PDF",
    "label": "Fiche PDF",
    "type": "Attachments",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 8
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "Liste_des_equipements_Diplomes",
    "label": "Liste_des_equipements_Diplômes",
    "type": "Text",
    "isFormula": true,
    "formula": "Liste_des_equipements.lookupRecords(Travaux=CONTAINS($id)).Diplomes_concernes",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 9
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "Liste_des_equipements_Etab",
    "label": "Liste_des_equipements_Etab",
    "type": "Any",
    "isFormula": true,
    "formula": "Liste_des_equipements.lookupRecords(Travaux=CONTAINS($id)).Etab",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 10
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "B",
    "label": "B",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 11
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "Diplomes_EN_OK",
    "label": "Diplômes EN OK",
    "type": "RefList:Diplomes_EN_OK",
    "isFormula": false,
    "formula": "",
    "isRef": true,
    "refTableId": "Diplomes_EN_OK",
    "visibleCol": 208,
    "description": "",
    "pos": 12
  },
  {
    "tableId": "Risques",
    "tableRef": 13,
    "colId": "gristHelper_Display",
    "label": "gristHelper_Display",
    "type": "Any",
    "isFormula": true,
    "formula": "$Diplomes_EN_OK.Commission_professionnelle_consultative",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 13
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "numero_uai",
    "label": "numero_uai",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "appellation_officielle",
    "label": "appellation_officielle",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "denomination_principale",
    "label": "denomination_principale",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "patronyme_uai",
    "label": "patronyme_uai",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 4
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "secteur_public_prive_libe",
    "label": "secteur_public_prive_libe",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 5
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "adresse_uai",
    "label": "adresse_uai",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 6
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "lieu_dit_uai",
    "label": "lieu_dit_uai",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 7
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "boite_postale_uai",
    "label": "boite_postale_uai",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 8
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "code_postal_uai",
    "label": "code_postal_uai",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 9
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "localite_acheminement_uai",
    "label": "localite_acheminement_uai",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 10
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "libelle_commune",
    "label": "libelle_commune",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 11
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "coordonnee_x",
    "label": "coordonnee_x",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 12
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "coordonnee_y",
    "label": "coordonnee_y",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 13
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "EPSG",
    "label": "EPSG",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 14
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "latitude",
    "label": "latitude",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 15
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "longitude",
    "label": "longitude",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 16
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "appariement",
    "label": "appariement",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 17
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "localisation",
    "label": "localisation",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 18
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "nature_uai",
    "label": "nature_uai",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 19
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "nature_uai_libe",
    "label": "nature_uai_libe",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 20
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "etat_etablissement",
    "label": "etat_etablissement",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 21
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "etat_etablissement_libe",
    "label": "etat_etablissement_libe",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 22
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "code_departement",
    "label": "code_departement",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 23
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "code_region",
    "label": "code_region",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 24
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "code_academie",
    "label": "code_academie",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 25
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "code_commune",
    "label": "code_commune",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 26
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "libelle_departement",
    "label": "libelle_departement",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 27
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "libelle_region",
    "label": "libelle_region",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 28
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "libelle_academie",
    "label": "libelle_academie",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 29
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "position",
    "label": "position",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 30
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "secteur_prive_code_type_contrat",
    "label": "secteur_prive_code_type_contrat",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 31
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "secteur_prive_libelle_type_contrat",
    "label": "secteur_prive_libelle_type_contrat",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 32
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "code_ministere",
    "label": "code_ministere",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 33
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "libelle_ministere",
    "label": "libelle_ministere",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 34
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "date_ouverture",
    "label": "date_ouverture",
    "type": "Date",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 35
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "sigle",
    "label": "sigle",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 36
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "Dipomes",
    "label": "Dipômes",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 37
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "Pour_tri",
    "label": "Pour tri",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 38
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "Liste_des_equipements_Source_du_risque",
    "label": "Liste_des_equipements_Source du risque",
    "type": "RefList:Risques",
    "isFormula": true,
    "formula": "Liste_des_equipements.lookupRecords(Etab=CONTAINS($id)).Travaux",
    "isRef": true,
    "refTableId": "Risques",
    "visibleCol": 0,
    "description": "",
    "pos": 39
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "Intitule_de_la_specialite_et_options",
    "label": "Intitule_de_la_specialite_et_options",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 40
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "Travaux_filtres",
    "label": "Travaux_filtres",
    "type": "Text",
    "isFormula": true,
    "formula": "\"\\n\".join(\n  f\"- {item}\"\n  for item in sorted(set(\n    str(i)\n    for t in $Liste_travaux_a_filtrer or []\n    for i in t.Source_du_risque_Travaux or []\n    if i\n  ))\n)",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 41
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "Liste_travaux_a_filtrer",
    "label": "Liste_travaux_a_filtrer",
    "type": "RefList:Liste_des_equipements",
    "isFormula": true,
    "formula": "",
    "isRef": true,
    "refTableId": "Liste_des_equipements",
    "visibleCol": 0,
    "description": "",
    "pos": 42
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "Concact_etab",
    "label": "Concact_etab",
    "type": "Any",
    "isFormula": true,
    "formula": "(\n    \n    f\"{$denomination_principale } \"\n    f\"{$patronyme_uai} \"\n    \n)",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 43
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "siret",
    "label": "siret",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 44
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "email_etab",
    "label": "email_etab",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 45
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "email_redacteur",
    "label": "email_redacteur",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 46
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "tel_etab",
    "label": "tel_etab",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 47
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "secteur_activite",
    "label": "secteur_activite",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 48
  },
  {
    "tableId": "Etablissements_edi",
    "tableRef": 15,
    "colId": "si_structure",
    "label": "si_structure",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 49
  },
  {
    "tableId": "Fiches_des_travaux",
    "tableRef": 16,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Fiches_des_travaux",
    "tableRef": 16,
    "colId": "N_de_fiche",
    "label": "N° de fiche",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Fiches_des_travaux",
    "tableRef": 16,
    "colId": "Travaux",
    "label": "Travaux",
    "type": "Ref:Risques",
    "isFormula": false,
    "formula": "",
    "isRef": true,
    "refTableId": "Risques",
    "visibleCol": 88,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Fiches_des_travaux",
    "tableRef": 16,
    "colId": "gristHelper_Display2",
    "label": "gristHelper_Display2",
    "type": "Any",
    "isFormula": true,
    "formula": "$Travaux.Travaux2",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "Fiches_des_travaux",
    "tableRef": 16,
    "colId": "A",
    "label": "A",
    "type": "Attachments",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 4
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Commission_professionnelle_consultative",
    "label": "Commission professionnelle consultative",
    "type": "Text",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Secteur",
    "label": "Secteur",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Niveau",
    "label": "Niveau",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Code_diplome",
    "label": "Code diplôme",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 4
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Diplome",
    "label": "Diplôme",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 5
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Intitule_de_la_specialite_et_options_",
    "label": "Intitulé de la spécialité (et options)",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 6
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Code_RNCP",
    "label": "Code RNCP",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 7
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Date_de_l_arrete_de_creation",
    "label": "Date de l'arrêté de création",
    "type": "Date",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 8
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Premiere_session",
    "label": "Première session",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 9
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Derniere_session",
    "label": "Dernière session",
    "type": "Numeric",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 10
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Commentaire",
    "label": "Commentaire",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 11
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Famille_de_metiers",
    "label": "Famille de métiers",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 12
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Concatenation",
    "label": "Concatenation",
    "type": "Text",
    "isFormula": true,
    "formula": "(\n    \n    f\"{$Diplome} \"\n    f\"{$Intitule_de_la_specialite_et_options_} \"\n    \n)",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 13
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Travaux_liees",
    "label": "Travaux_liees",
    "type": "RefList:Liste_des_equipements",
    "isFormula": false,
    "formula": "",
    "isRef": true,
    "refTableId": "Liste_des_equipements",
    "visibleCol": 3,
    "description": "",
    "pos": 14
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "gristHelper_Display2",
    "label": "gristHelper_Display2",
    "type": "Any",
    "isFormula": true,
    "formula": "$Travaux_liees.Equipements_ou_produits",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 15
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Travaux_filtres",
    "label": "Travaux_filtres",
    "type": "Any",
    "isFormula": true,
    "formula": "\"\\n\".join(\n  f\"- {item}\"\n  for item in sorted(set(\n    str(i)\n    for t in $Liste_travaux_a_filtrer or []\n    for i in t.Source_du_risque_Travaux or []\n    if i\n  ))\n)",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 16
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "mise_en_forme",
    "label": "mise en forme",
    "type": "Any",
    "isFormula": true,
    "formula": "$Travaux_filtres",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 17
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "Tous_Etablissements",
    "label": "Tous_Etablissements",
    "type": "RefList:Etablissements_edi",
    "isFormula": false,
    "formula": "",
    "isRef": true,
    "refTableId": "Etablissements_edi",
    "visibleCol": 340,
    "description": "",
    "pos": 18
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "gristHelper_Display3",
    "label": "gristHelper_Display3",
    "type": "Any",
    "isFormula": true,
    "formula": "$Tous_Etablissements.Concact_etab",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 19
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "A",
    "label": "Contenu avis medical",
    "type": "Any",
    "isFormula": true,
    "formula": "html = \"<div style='font-family: Arial, sans-serif; max-width: 700px; margin: auto; padding: 20px; border: 1px solid #ccc;'>\"\n\nhtml += \"\"\"\n<style>\n  .avis-container {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n  }\n  .avis",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 20
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "B",
    "label": "B",
    "type": "Any",
    "isFormula": true,
    "formula": "\nhtml = \"<div style='font-family: Arial, sans-serif; max-width: 700px; margin: auto; padding: 20px; border: 1px solid #ccc;'>\"\n\nhtml += \"\"\"\n<style>\n\n<style>\n  .avis-container {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n ",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 21
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "C",
    "label": "C",
    "type": "Any",
    "isFormula": true,
    "formula": "html = \"\"\"\n<div style='font-family: Arial, sans-serif; max-width: 800px; margin: auto; padding: 20px; border: 1px solid #ccc;'>\n\n<style>\n  .avis-bloc {\n    display: flex;\n    align-items: center;\n    margin-bottom: 10px;\n  }\n  .avis-bloc in",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 22
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "D",
    "label": "D",
    "type": "Any",
    "isFormula": true,
    "formula": "html = \"\"\"\n<div style='font-family: Arial, sans-serif; max-width: 700px; margin: auto; padding: 20px; border: 1px solid #ccc;'>\n\n<style>\n  .avis-medical-container {\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n  }\n\n  .avis-",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 23
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "gristHelper_RowConditionalRule",
    "label": "gristHelper_RowConditionalRule",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 24
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "formation_affichee",
    "label": "formation_affichee",
    "type": "Text",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 25
  },
  {
    "tableId": "Diplomes_EN_OK",
    "tableRef": 20,
    "colId": "declaration",
    "label": "declaration",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 26
  },
  {
    "tableId": "Fichiers",
    "tableRef": 28,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Fichiers",
    "tableRef": 28,
    "colId": "Nom_du_fichier",
    "label": "Nom du fichier",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Fichiers",
    "tableRef": 28,
    "colId": "Fichier",
    "label": "Fichier",
    "type": "Attachments",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Fichiers",
    "tableRef": 28,
    "colId": "FichierPDF",
    "label": "FichierPDF",
    "type": "Text",
    "isFormula": true,
    "formula": "str($Fichier[0]) if $Fichier else None",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "Fichiers",
    "tableRef": 28,
    "colId": "A",
    "label": "A",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 4
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "manualSort",
    "label": "manualSort",
    "type": "ManualSortPos",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 0
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "Etablissement",
    "label": "Etablissement",
    "type": "Text",
    "isFormula": false,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 1
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "B",
    "label": "B",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 2
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "C",
    "label": "C",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 3
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "A",
    "label": "A",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 4
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "D",
    "label": "D",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 5
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "E",
    "label": "E",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 6
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "F",
    "label": "F",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 7
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "G",
    "label": "G",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 8
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "H",
    "label": "H",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 9
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "I",
    "label": "I",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 10
  },
  {
    "tableId": "Form_derogation",
    "tableRef": 29,
    "colId": "J",
    "label": "J",
    "type": "Any",
    "isFormula": true,
    "formula": "",
    "isRef": false,
    "refTableId": "",
    "visibleCol": 0,
    "description": "",
    "pos": 11
  }
]