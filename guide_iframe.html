<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Prévention PACA – P</title>
    <link rel="preconnect" href="https://docs.getgrist.com">
    <link rel="dns-prefetch" href="https://docs.getgrist.com">
    <style>
        :root{--bg:#020617;--grist-offset:56px}
        html,body{margin:0;padding:0;height:100%;background:var(--bg);overflow:hidden}
        #wrapper{position:fixed;inset:0;overflow:hidden;background:var(--bg)}
        #gristFrame{position:absolute;top:calc(-1*var(--grist-offset));left:0;width:100%;height:calc(100% + var(--grist-offset));border:0;background:var(--bg)}
        #ppBadge{position:fixed;right:10px;bottom:10px;z-index:9999;font:10px system-ui;color:rgba(226,232,240,.4);pointer-events:none}
    </style>
</head>
<body>
<div id="wrapper"><iframe id="gristFrame" src="about:blank" allowfullscreen></iframe></div>
<div id="ppBadge">V20_Performance_Optimized</div>

<script>
  const HOME = "https://docs.getgrist.com/gvPEJV3qAHS9/Equipements-de-travail-et-produits/p/59?embed=true&style=singlePage&exclude-headers=true";

  function decodeMany(s, max=3){
    let out = s || "";
    for(let i=0;i<max;i++){
      try{
        const d = decodeURIComponent(out);
        if(d === out) break;
        out = d;
      }catch(e){ break; }
    }
    return out;
  }

  function getTarget(){
    const sp = new URLSearchParams(window.location.search);
    const src = sp.get("src");
    if(src) return decodeMany(src, 4);

    // compat : ancien mode hash "wrapper#https://..."
    const h = window.location.hash ? window.location.hash.slice(1) : "";
    if(h && /^https?:\/\//i.test(decodeMany(h, 2))) return decodeMany(h, 2);

    return HOME;
  }

  function setFrame(){
    const url = getTarget();
    document.getElementById("gristFrame").src = url || HOME;
  }

  setFrame();
  window.addEventListener("hashchange", setFrame);
</script>


</body>
</html>


